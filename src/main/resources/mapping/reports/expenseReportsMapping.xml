<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.admin.dao.reports.ExpenseReportsDao">
    <resultMap id="expenseReportsMap" type="com.admin.entity.reports.ExpenseReports">
        <id property="id" column="id"/>
        <result property="name" column="name"/>
        <result property="month" column="month"/>
        <result property="fuelCharge" column="fuel_charge"/>
        <result property="busFee" column="bus_fee"/>
        <result property="taxiFee" column="taxi_fee"/>
        <result property="telephoneCharge" column="telephone_charge"/>
        <result property="feteFee" column="fete_fee"/>
        <result property="travellingExpenses" column="travelling_expenses"/>
        <result property="marketingCosts" column="marketing_costs"/>
        <result property="allCosts" column="all_costs"/>
        <result property="enable" column="enable"/>
        <result property="createdBy" column="created_by"/>
        <result property="createdAt" column="created_at"/>
        <result property="updatedBy" column="updated_by"/>
        <result property="updatedAt" column="updated_at"/>
        <result property="remark" column="remark"/>
    </resultMap>

    <sql id="columns">
        name,month,fuel_charge,bus_fee,taxi_fee,telephone_charge,fete_fee,travelling_expenses,marketing_costs,all_costs,enable,created_by,created_at,updated_by,updated_at,remark
    </sql>
    <sql id="table">expense_reports</sql>

    <select id="getById" resultMap="expenseReportsMap" parameterType="java.lang.Integer">
        select id,<include refid="columns"/>
        from <include refid="table"/>
        where id = #{id}
    </select>

    <select id="getExpenseReportsList"  parameterType="Map"  resultMap="expenseReportsMap">
        SELECT id,<include refid="columns"/>
        FROM <include refid="table"/>
        WHERE enable = 1
        <include refid="expenseReportsQuery"/>
        Order By updated_at DESC
        <if test="m!=null and n!=null">
            Limit ${m},${n}
        </if>
    </select>

    <sql id="expenseReportsQuery">
        <if test="customerName != null and customerName != ''">
            AND customer_name = #{customerName}
        </if>
        <if test="status != null">
            AND status = #{status}
        </if>
    </sql>

    <insert id="insert" parameterType="com.admin.entity.reports.ExpenseReports" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO <include refid="table"/>(<include refid="columns"/>)
        VALUES(
        #{name},
        #{month},
        #{fuelCharge},
        #{busFee},
        #{taxiFee},
        #{telephoneCharge},
        #{feteFee},
        #{travellingExpenses},
        #{marketingCosts},
        #{allCosts},
        1,
        #{createdBy},
        now(),
        #{updatedBy},
        now(),
        #{remark}
        )
    </insert>
</mapper>
